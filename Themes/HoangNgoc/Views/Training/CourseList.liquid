{% comment %}
Training Course List View - HoangNgoc Theme
Displays available courses with filtering and search
{% endcomment %}

<div class="course-list-page" data-animate="fade-in">
    <!-- Page Header -->
    <div class="page-header-section">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-md-8">
                    <h1 class="page-title">Khóa học đào tạo</h1>
                    <p class="page-subtitle">Khám phá các khóa học chất lượng cao được thiết kế bởi chuyên gia</p>
                </div>
                <div class="col-md-4 text-right">
                    <div class="course-stats">
                        <div class="stat-item">
                            <span class="stat-number">{{ Model.TotalCourses | default: 0 }}</span>
                            <span class="stat-label">Khóa học</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-number">{{ Model.TotalStudents | default: 0 }}</span>
                            <span class="stat-label">Học viên</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Filters and Search -->
    <div class="filters-section">
        <div class="container">
            <div class="filters-wrapper">
                <div class="row">
                    <div class="col-md-6">
                        <div class="search-box">
                            <form method="get" action="{{ Request.Path }}">
                                <div class="input-group">
                                    <input type="text" name="search" class="form-control search-input" 
                                           placeholder="Tìm kiếm khóa học..." 
                                           value="{{ Request.Query.search }}">
                                    <button type="submit" class="btn btn-primary">
                                        <i class="fas fa-search"></i>
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="filter-controls">
                            <select name="category" class="form-control filter-select" onchange="this.form.submit()">
                                <option value="">Tất cả danh mục</option>
                                {% for category in Model.Categories %}
                                    <option value="{{ category.Id }}" 
                                            {% if Request.Query.category == category.Id %}selected{% endif %}>
                                        {{ category.Name }}
                                    </option>
                                {% endfor %}
                            </select>
                            <select name="level" class="form-control filter-select" onchange="this.form.submit()">
                                <option value="">Tất cả cấp độ</option>
                                <option value="beginner" {% if Request.Query.level == 'beginner' %}selected{% endif %}>Cơ bản</option>
                                <option value="intermediate" {% if Request.Query.level == 'intermediate' %}selected{% endif %}>Trung cấp</option>
                                <option value="advanced" {% if Request.Query.level == 'advanced' %}selected{% endif %}>Nâng cao</option>
                            </select>
                            <select name="sort" class="form-control filter-select" onchange="this.form.submit()">
                                <option value="newest" {% if Request.Query.sort == 'newest' %}selected{% endif %}>Mới nhất</option>
                                <option value="popular" {% if Request.Query.sort == 'popular' %}selected{% endif %}>Phổ biến</option>
                                <option value="rating" {% if Request.Query.sort == 'rating' %}selected{% endif %}>Đánh giá cao</option>
                                <option value="price_low" {% if Request.Query.sort == 'price_low' %}selected{% endif %}>Giá thấp</option>
                                <option value="price_high" {% if Request.Query.sort == 'price_high' %}selected{% endif %}>Giá cao</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Course Grid -->
    <div class="courses-section">
        <div class="container">
            {% if Model.Courses.size > 0 %}
                <div class="courses-grid">
                    {% for course in Model.Courses %}
                        <div class="course-card" data-animate="slide-up">
                            <div class="course-image">
                                {% if course.ThumbnailUrl %}
                                    <img src="{{ course.ThumbnailUrl | asset_url }}" alt="{{ course.Title }}" loading="lazy">
                                {% else %}
                                    <div class="course-placeholder">
                                        <i class="fas fa-graduation-cap"></i>
                                    </div>
                                {% endif %}
                                <div class="course-overlay">
                                    <a href="{{ course.Url | href }}" class="btn btn-primary btn-sm">
                                        <i class="fas fa-eye"></i> Xem chi tiết
                                    </a>
                                </div>
                                {% if course.IsFeatured %}
                                    <div class="course-badge featured">
                                        <i class="fas fa-star"></i> Nổi bật
                                    </div>
                                {% endif %}
                                {% if course.IsNew %}
                                    <div class="course-badge new">
                                        <i class="fas fa-sparkles"></i> Mới
                                    </div>
                                {% endif %}
                            </div>
                            
                            <div class="course-content">
                                <div class="course-meta">
                                    <span class="course-category">{{ course.Category.Name }}</span>
                                    <span class="course-level {{ course.Level | downcase }}">{{ course.Level }}</span>
                                </div>
                                
                                <h3 class="course-title">
                                    <a href="{{ course.Url | href }}">{{ course.Title }}</a>
                                </h3>
                                
                                <p class="course-description">{{ course.Description | truncate: 120 }}</p>
                                
                                <div class="course-instructor">
                                    <div class="instructor-avatar">
                                        {% if course.Instructor.Avatar %}
                                            <img src="{{ course.Instructor.Avatar | asset_url }}" alt="{{ course.Instructor.Name }}">
                                        {% else %}
                                            <div class="avatar-placeholder">
                                                <i class="fas fa-user"></i>
                                            </div>
                                        {% endif %}
                                    </div>
                                    <div class="instructor-info">
                                        <span class="instructor-name">{{ course.Instructor.Name }}</span>
                                        <span class="instructor-title">{{ course.Instructor.Title }}</span>
                                    </div>
                                </div>
                                
                                <div class="course-stats">
                                    <div class="stat-item">
                                        <i class="fas fa-users"></i>
                                        <span>{{ course.StudentsCount | default: 0 }} học viên</span>
                                    </div>
                                    <div class="stat-item">
                                        <i class="fas fa-clock"></i>
                                        <span>{{ course.Duration }} giờ</span>
                                    </div>
                                    <div class="stat-item">
                                        <i class="fas fa-play-circle"></i>
                                        <span>{{ course.LessonsCount }} bài học</span>
                                    </div>
                                </div>
                                
                                {% if course.Rating > 0 %}
                                    <div class="course-rating">
                                        <div class="stars">
                                            {% for i in (1..5) %}
                                                {% if i <= course.Rating %}
                                                    <i class="fas fa-star"></i>
                                                {% else %}
                                                    <i class="far fa-star"></i>
                                                {% endif %}
                                            {% endfor %}
                                        </div>
                                        <span class="rating-text">{{ course.Rating }}/5 ({{ course.ReviewsCount }} đánh giá)</span>
                                    </div>
                                {% endif %}
                            </div>
                            
                            <div class="course-footer">
                                <div class="course-price">
                                    {% if course.DiscountPrice %}
                                        <span class="original-price">{{ course.Price | currency: "VND" }}</span>
                                        <span class="discount-price">{{ course.DiscountPrice | currency: "VND" }}</span>
                                    {% elsif course.Price > 0 %}
                                        <span class="current-price">{{ course.Price | currency: "VND" }}</span>
                                    {% else %}
                                        <span class="free-price">Miễn phí</span>
                                    {% endif %}
                                </div>
                                
                                <div class="course-actions">
                                    {% if course.IsEnrolled %}
                                        <a href="{{ course.StudyUrl | href }}" class="btn btn-success btn-sm">
                                            <i class="fas fa-play"></i> Tiếp tục học
                                        </a>
                                    {% else %}
                                        <a href="{{ course.EnrollUrl | href }}" class="btn btn-primary btn-sm">
                                            <i class="fas fa-shopping-cart"></i> Đăng ký
                                        </a>
                                    {% endif %}
                                    <button class="btn btn-outline btn-sm wishlist-btn" data-course-id="{{ course.Id }}">
                                        <i class="{% if course.IsInWishlist %}fas{% else %}far{% endif %} fa-heart"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    {% endfor %}
                </div>
                
                <!-- Pagination -->
                {% if Model.Pager.TotalPages > 1 %}
                    <div class="pagination-wrapper">
                        <nav aria-label="Course pagination">
                            <ul class="pagination">
                                {% if Model.Pager.HasPreviousPage %}
                                    <li class="page-item">
                                        <a class="page-link" href="{{ Model.Pager.PreviousPageUrl }}">
                                            <i class="fas fa-chevron-left"></i> Trước
                                        </a>
                                    </li>
                                {% endif %}
                                
                                {% for page in Model.Pager.Pages %}
                                    <li class="page-item {% if page.IsCurrent %}active{% endif %}">
                                        <a class="page-link" href="{{ page.Url }}">{{ page.Number }}</a>
                                    </li>
                                {% endfor %}
                                
                                {% if Model.Pager.HasNextPage %}
                                    <li class="page-item">
                                        <a class="page-link" href="{{ Model.Pager.NextPageUrl }}">
                                            Sau <i class="fas fa-chevron-right"></i>
                                        </a>
                                    </li>
                                {% endif %}
                            </ul>
                        </nav>
                    </div>
                {% endif %}
            {% else %}
                <div class="empty-state">
                    <i class="fas fa-graduation-cap"></i>
                    <h3>Không tìm thấy khóa học nào</h3>
                    <p>Thử thay đổi bộ lọc hoặc từ khóa tìm kiếm để xem thêm khóa học.</p>
                    <a href="{{ '~/Training' | href }}" class="btn btn-primary">Xem tất cả khóa học</a>
                </div>
            {% endif %}
        </div>
    </div>
</div>

<style>
.course-list-page {
    min-height: 100vh;
}

.page-header-section {
    background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-dark) 100%);
    color: var(--text-light);
    padding: 3rem 0;
    margin-bottom: 2rem;
}

.page-header-section .page-title {
    color: var(--text-light);
    margin-bottom: 0.5rem;
}

.page-header-section .page-subtitle {
    opacity: 0.9;
    margin-bottom: 0;
}

.course-stats {
    display: flex;
    gap: 2rem;
    justify-content: flex-end;
}

.course-stats .stat-item {
    text-align: center;
}

.stat-number {
    display: block;
    font-size: var(--font-size-2xl);
    font-weight: 700;
    color: var(--text-light);
}

.stat-label {
    font-size: var(--font-size-sm);
    opacity: 0.8;
}

.filters-section {
    background-color: var(--bg-secondary);
    padding: 1.5rem 0;
    margin-bottom: 2rem;
}

.filters-wrapper {
    background-color: var(--bg-primary);
    border-radius: var(--border-radius);
    padding: 1.5rem;
    box-shadow: var(--shadow-sm);
}

.search-box .input-group {
    display: flex;
}

.search-box .form-control {
    border-top-right-radius: 0;
    border-bottom-right-radius: 0;
}

.search-box .btn {
    border-top-left-radius: 0;
    border-bottom-left-radius: 0;
    border-left: none;
}

.filter-controls {
    display: flex;
    gap: 1rem;
}

.filter-select {
    flex: 1;
}

.courses-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
    gap: 2rem;
    margin-bottom: 3rem;
}

.course-card {
    background-color: var(--bg-primary);
    border-radius: var(--border-radius-lg);
    box-shadow: var(--shadow-md);
    overflow: hidden;
    transition: var(--transition);
    position: relative;
}

.course-card:hover {
    transform: translateY(-5px);
    box-shadow: var(--shadow-lg);
}

.course-image {
    position: relative;
    height: 200px;
    overflow: hidden;
}

.course-image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: var(--transition);
}

.course-card:hover .course-image img {
    transform: scale(1.05);
}

.course-placeholder {
    width: 100%;
    height: 100%;
    background: linear-gradient(135deg, var(--primary-light) 0%, var(--primary-color) 100%);
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--text-light);
    font-size: 3rem;
}

.course-overlay {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: var(--bg-overlay);
    display: flex;
    align-items: center;
    justify-content: center;
    opacity: 0;
    transition: var(--transition);
}

.course-card:hover .course-overlay {
    opacity: 1;
}

.course-badge {
    position: absolute;
    top: 1rem;
    right: 1rem;
    padding: 0.25rem 0.75rem;
    border-radius: var(--border-radius-full);
    font-size: var(--font-size-xs);
    font-weight: 600;
    color: var(--text-light);
    z-index: 2;
}

.course-badge.featured {
    background-color: var(--warning-color);
}

.course-badge.new {
    background-color: var(--success-color);
}

.course-content {
    padding: 1.5rem;
}

.course-meta {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 1rem;
}

.course-category {
    background-color: var(--primary-color);
    color: var(--text-light);
    padding: 0.25rem 0.75rem;
    border-radius: var(--border-radius-full);
    font-size: var(--font-size-xs);
    font-weight: 500;
}

.course-level {
    padding: 0.25rem 0.75rem;
    border-radius: var(--border-radius-full);
    font-size: var(--font-size-xs);
    font-weight: 500;
    text-transform: uppercase;
}

.course-level.beginner {
    background-color: var(--success-color);
    color: var(--text-light);
}

.course-level.intermediate {
    background-color: var(--warning-color);
    color: var(--text-light);
}

.course-level.advanced {
    background-color: var(--error-color);
    color: var(--text-light);
}

.course-title {
    font-size: var(--font-size-lg);
    font-weight: 600;
    margin-bottom: 0.75rem;
    line-height: 1.4;
}

.course-title a {
    color: var(--text-primary);
    text-decoration: none;
    transition: var(--transition-fast);
}

.course-title a:hover {
    color: var(--primary-color);
}

.course-description {
    color: var(--text-secondary);
    font-size: var(--font-size-sm);
    line-height: 1.5;
    margin-bottom: 1rem;
}

.course-instructor {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    margin-bottom: 1rem;
    padding-bottom: 1rem;
    border-bottom: 1px solid var(--border-light);
}

.instructor-avatar {
    flex: 0 0 40px;
}

.instructor-avatar img,
.instructor-avatar .avatar-placeholder {
    width: 40px;
    height: 40px;
    border-radius: 50%;
}

.instructor-avatar .avatar-placeholder {
    background-color: var(--bg-secondary);
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--text-muted);
}

.instructor-info {
    display: flex;
    flex-direction: column;
}

.instructor-name {
    font-weight: 500;
    font-size: var(--font-size-sm);
    color: var(--text-primary);
}

.instructor-title {
    font-size: var(--font-size-xs);
    color: var(--text-muted);
}

.course-stats {
    display: flex;
    justify-content: space-between;
    margin-bottom: 1rem;
}

.course-stats .stat-item {
    display: flex;
    align-items: center;
    gap: 0.25rem;
    font-size: var(--font-size-xs);
    color: var(--text-muted);
}

.course-stats .stat-item i {
    color: var(--primary-color);
}

.course-rating {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin-bottom: 1rem;
}

.stars {
    display: flex;
    gap: 0.125rem;
}

.stars i {
    color: var(--warning-color);
    font-size: var(--font-size-sm);
}

.rating-text {
    font-size: var(--font-size-xs);
    color: var(--text-muted);
}

.course-footer {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 1rem 1.5rem;
    background-color: var(--bg-secondary);
    border-top: 1px solid var(--border-light);
}

.course-price {
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.original-price {
    text-decoration: line-through;
    color: var(--text-muted);
    font-size: var(--font-size-sm);
}

.discount-price,
.current-price {
    font-weight: 700;
    color: var(--primary-color);
    font-size: var(--font-size-lg);
}

.free-price {
    font-weight: 700;
    color: var(--success-color);
    font-size: var(--font-size-lg);
}

.course-actions {
    display: flex;
    gap: 0.5rem;
}

.wishlist-btn {
    width: 36px;
    height: 36px;
    padding: 0;
    display: flex;
    align-items: center;
    justify-content: center;
}

.wishlist-btn.active {
    color: var(--error-color);
}

.pagination-wrapper {
    display: flex;
    justify-content: center;
    margin-top: 3rem;
}

.pagination {
    display: flex;
    list-style: none;
    gap: 0.5rem;
    margin: 0;
    padding: 0;
}

.page-item {
    display: flex;
}

.page-link {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 0.75rem 1rem;
    background-color: var(--bg-primary);
    border: 1px solid var(--border-color);
    border-radius: var(--border-radius);
    color: var(--text-primary);
    text-decoration: none;
    transition: var(--transition-fast);
}

.page-link:hover,
.page-item.active .page-link {
    background-color: var(--primary-color);
    border-color: var(--primary-color);
    color: var(--text-light);
    text-decoration: none;
}

.empty-state {
    text-align: center;
    padding: 4rem 2rem;
}

.empty-state i {
    font-size: 4rem;
    color: var(--text-muted);
    margin-bottom: 1.5rem;
}

.empty-state h3 {
    margin-bottom: 1rem;
    color: var(--text-primary);
}

.empty-state p {
    color: var(--text-secondary);
    margin-bottom: 2rem;
    max-width: 500px;
    margin-left: auto;
    margin-right: auto;
}

@media (max-width: 768px) {
    .course-stats {
        flex-direction: column;
        gap: 1rem;
        text-align: center;
    }
    
    .filters-wrapper .row {
        flex-direction: column;
        gap: 1rem;
    }
    
    .filter-controls {
        flex-direction: column;
    }
    
    .courses-grid {
        grid-template-columns: 1fr;
        gap: 1.5rem;
    }
    
    .course-footer {
        flex-direction: column;
        gap: 1rem;
        text-align: center;
    }
    
    .course-actions {
        justify-content: center;
    }
}
</style>