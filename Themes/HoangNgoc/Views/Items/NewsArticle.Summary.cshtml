@using HoangNgoc.News.Models
@using OrchardCore.ContentManagement
@using Microsoft.AspNetCore.Html

@{
    ContentItem contentItem = Model.ContentItem;
    var newsArticlePart = contentItem.As<NewsArticlePart>();
    var title = contentItem.DisplayText;
    var summary = newsArticlePart?.Summary?.Value ?? "";
    var imageUrl = newsArticlePart?.FeaturedImage?.Paths?.FirstOrDefault() ?? "/Themes/HoangNgoc/wwwroot/images/placeholder-news.jpg";
    var publishedDate = contentItem.PublishedUtc?.ToString("dd/MM/yyyy") ?? "";
    var author = newsArticlePart?.Author?.Text ?? "Admin";
    var category = newsArticlePart?.Category?.Text ?? "Tin tức";
    var viewCount = newsArticlePart?.ViewCount ?? 0;
}

<article class="news-article-summary card h-100 shadow-sm border-0 hover-lift" itemscope itemtype="https://schema.org/NewsArticle">
    <!-- Featured Image -->
    <div class="news-image-wrapper position-relative overflow-hidden">
        <img src="@imageUrl" 
             class="card-img-top news-featured-image" 
             alt="@title"
             loading="lazy"
             itemprop="image"
             style="height: 200px; object-fit: cover;" />
        
        <!-- Category Badge -->
        <div class="position-absolute top-0 start-0 m-3">
            <span class="badge bg-primary rounded-pill px-3 py-2 shadow-sm">
                <i class="fas fa-tag me-1"></i>@category
            </span>
        </div>
        
        <!-- View Count Badge -->
        <div class="position-absolute top-0 end-0 m-3">
            <span class="badge bg-dark bg-opacity-75 rounded-pill px-3 py-2">
                <i class="fas fa-eye me-1"></i>@viewCount.ToString("N0")
            </span>
        </div>
    </div>
    
    <div class="card-body d-flex flex-column">
        <!-- Article Meta -->
        <div class="news-meta mb-3">
            <div class="d-flex align-items-center text-muted small">
                <div class="me-3">
                    <i class="fas fa-calendar-alt me-1"></i>
                    <time datetime="@contentItem.PublishedUtc?.ToString("yyyy-MM-dd")" itemprop="datePublished">@publishedDate</time>
                </div>
                <div class="me-3">
                    <i class="fas fa-user me-1"></i>
                    <span itemprop="author">@author</span>
                </div>
                <div>
                    <i class="fas fa-clock me-1"></i>
                    <span>3 phút đọc</span>
                </div>
            </div>
        </div>
        
        <!-- Article Title -->
        <h3 class="card-title news-title mb-3">
            <a href="@Url.RouteUrl(new { area = "OrchardCore.Contents", controller = "Item", action = "Display", contentItemId = contentItem.ContentItemId })" 
               class="text-decoration-none text-dark stretched-link"
               itemprop="headline">
                @title
            </a>
        </h3>
        
        <!-- Article Summary -->
        <div class="news-summary text-muted mb-4 flex-grow-1" itemprop="description">
            @if (!string.IsNullOrEmpty(summary))
            {
                <p class="mb-0">@Html.Raw(summary.Length > 150 ? summary.Substring(0, 150) + "..." : summary)</p>
            }
            else
            {
                <p class="mb-0">Đọc bài viết để tìm hiểu thêm thông tin chi tiết...</p>
            }
        </div>
        
        <!-- Article Actions -->
        <div class="news-actions d-flex justify-content-between align-items-center">
            <div class="news-tags">
                @if (newsArticlePart?.Tags?.Values?.Any() == true)
                {
                    @foreach (var tag in newsArticlePart.Tags.Values.Take(2))
                    {
                        <span class="badge bg-light text-dark me-1">
                            <i class="fas fa-hashtag me-1"></i>@tag
                        </span>
                    }
                }
            </div>
            
            <div class="news-read-more">
                <span class="btn btn-outline-primary btn-sm">
                    Đọc tiếp <i class="fas fa-arrow-right ms-1"></i>
                </span>
            </div>
        </div>
    </div>
</article>